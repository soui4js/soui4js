import { IObjRef } from "soui4/IObjRef";
import { ISkinObj } from "soui4/ISkinObj";
import { IXmlNode } from "soui4/IXml";
import { DWORD, HMENU, HWND, UINT, int } from "soui4/Typedef";

export class IMenu extends IObjRef{
    Attach(hmenu:HMENU) :boolean;

    Detach() :HMENU;

    GetHMenu():HMENU;

    LoadMenu(resId:string) :boolean;

    LoadMenu2(xmlMenu:IXmlNode) :boolean;

    SetIconSkin(icons:ISkinObj) :void;

    /**
     * SMenu::InsertMenu
     * @brief    插入一个菜单项,参数和Windows API类似。
     * @param    int iIcon -- 显示的标图在iconSkin中的索引
     * @param    HICON hIcon -- 标图，默认为0，有值时，iIocn失效
     * @return   BOOL - TRUE:成功
     *
     * Describe  hIcon会在菜单退出时自动调用DestroyIcon.
     */
    InsertMenu(uPosition:UINT , uFlags:UINT , nIDNewItem:number, strText:string , iIcon:int, hIcon:HICON) :boolean;

    AppendMenu(uFlags:UINT , nIDNewItem:number, strText:string , iIcon:int, hIcon:HICON) :boolean;

    CheckMenuItem(uIdCheckItem:UINT , uCheck:UINT ) :boolean;

    CheckMenuRadioItem( idFirst:UINT , idLast:UINT , idCheck:UINT , uFlags:UINT ) :boolean;

    DeleteMenu( uPosition:UINT , uFlags:UINT ) :boolean;

    TrackPopupMenu( uFlags:UINT , x:int, y: int,  hWnd:HWND,  prcRect:LPCRECT, nScale:int) :UINT;

    DestroyMenu() :void;

    ModifyMenuString( uPosition:UINT, uFlags:UINT, lpItemString:LPCTSTR ) :boolean;

    SetMenuUserData( uPosition:UINT , uFlags:UINT ,  ulUserData:ULONG_PTR) :boolean;

    GetMenuUserData( uPosition:UINT , uFlags:UINT ) :ULONG_PTR;

    GetContextHelpId()  :DWORD;

    SetContextHelpId( dwId:DWORD ) :void;

    GetSubMenu( nPos:int) :HMENU;
}